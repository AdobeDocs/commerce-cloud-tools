"use strict";(self.webpackChunkcommerce_cloud_tools=self.webpackChunkcommerce_cloud_tools||[]).push([[9345],{43059:function(e,n,o){o.r(n),o.d(n,{_frontmatter:function(){return l},default:function(){return u}});var a=o(87462),t=o(45987),d=(o(35776),o(3905)),m=o(91515);const r=["components"],l={},i=(p="InlineAlert",function(e){return console.warn("Component "+p+" was not imported, exported, or provided by MDXProvider as global scope"),(0,d.mdx)("div",e)});var p;const c={_frontmatter:l},s=m.Z;function u(e){let{components:n}=e,o=(0,t.Z)(e,r);return(0,d.mdx)(s,(0,a.Z)({},c,o,{components:n,mdxType:"MDXLayout"}),(0,d.mdx)("h1",{id:"cli-containers"},"CLI containers"),(0,d.mdx)("p",null,"The following CLI containers, most of which are based on a ",(0,d.mdx)("a",{parentName:"p",href:"https://hub.docker.com/r/magento/magento-cloud-docker-php"},"PHP-CLI version 7 image"),", provide ",(0,d.mdx)("inlineCode",{parentName:"p"},"magento-cloud")," and ",(0,d.mdx)("inlineCode",{parentName:"p"},"ece-tools")," commands to perform file system operations and interact with the application."),(0,d.mdx)("p",null,"Operations include:"),(0,d.mdx)("ul",null,(0,d.mdx)("li",{parentName:"ul"},(0,d.mdx)("inlineCode",{parentName:"li"},"build"),"—extends the CLI container to perform operations with writable filesystem, similar to the build phase"),(0,d.mdx)("li",{parentName:"ul"},(0,d.mdx)("inlineCode",{parentName:"li"},"deploy"),"—extends the CLI container to use read-only file system, similar to the deploy phase"),(0,d.mdx)("li",{parentName:"ul"},(0,d.mdx)("inlineCode",{parentName:"li"},"cron"),"—extends the CLI container to run cron"),(0,d.mdx)("li",{parentName:"ul"},(0,d.mdx)("inlineCode",{parentName:"li"},"node"),"—based on node image, used for NPM activities")),(0,d.mdx)("p",null,"For example, you can check the state of your project using the ",(0,d.mdx)("em",{parentName:"p"},"ideal-state")," wizard:"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-bash"},"docker compose run --rm deploy ece-command wizard:ideal-state\n")),(0,d.mdx)("p",null,"Sample response:"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-terminal"},' - Your application does not have the "post_deploy" hook enabled.\nThe configured state is not ideal\n')),(0,d.mdx)("p",null,"All build and deploy processes are defined and configured using ece-tools and the Cloud template."),(0,d.mdx)("h2",{id:"cli-container-commands"},"CLI container commands"),(0,d.mdx)("p",null,"These commands are available in the Cloud Docker for Commerce environment:"),(0,d.mdx)("table",null,(0,d.mdx)("thead",{parentName:"table"},(0,d.mdx)("tr",{parentName:"thead"},(0,d.mdx)("th",{parentName:"tr",align:null},"Command"),(0,d.mdx)("th",{parentName:"tr",align:null},"Target Containers"),(0,d.mdx)("th",{parentName:"tr",align:null},"Notes"))),(0,d.mdx)("tbody",{parentName:"table"},(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"cloud-build")),(0,d.mdx)("td",{parentName:"tr",align:null},"build"),(0,d.mdx)("td",{parentName:"tr",align:null},"Build the application in production mode, configured by the build hook in the ",(0,d.mdx)("inlineCode",{parentName:"td"},".magento.app.yml")," file")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"cloud-deploy")),(0,d.mdx)("td",{parentName:"tr",align:null},"deploy"),(0,d.mdx)("td",{parentName:"tr",align:null},"Deploy the application, configured by the deploy hook in the ",(0,d.mdx)("inlineCode",{parentName:"td"},".magento.app.yml")," file")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"cloud-post-deploy")),(0,d.mdx)("td",{parentName:"tr",align:null},"deploy"),(0,d.mdx)("td",{parentName:"tr",align:null},"Run post deploy hooks, configured by the post deploy hook in the ",(0,d.mdx)("inlineCode",{parentName:"td"},".magento.app.yml")," file")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"ece-command")),(0,d.mdx)("td",{parentName:"tr",align:null},"deploy"),(0,d.mdx)("td",{parentName:"tr",align:null},"Run ",(0,d.mdx)("a",{parentName:"td",href:"https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/dev-tools/ece-tools/package-overview.html"},"ece-tools CLI commands"))),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"magento-command")),(0,d.mdx)("td",{parentName:"tr",align:null},"deploy"),(0,d.mdx)("td",{parentName:"tr",align:null},"Run bin/magento commands")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"mftf-command")),(0,d.mdx)("td",{parentName:"tr",align:null},"deploy"),(0,d.mdx)("td",{parentName:"tr",align:null},"Run MFTF command for testing")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"run-cron")),(0,d.mdx)("td",{parentName:"tr",align:null},"cron"),(0,d.mdx)("td",{parentName:"tr",align:null},"Run cron jobs")))),(0,d.mdx)("p",null,"See the ",(0,d.mdx)("a",{parentName:"p",href:"https://github.com/magento/magento-cloud-docker/tree/develop/images/php/cli/bin"},"scripts in the Cloud Docker for Commerce GitHub repository")," to understand the processing for each command."),(0,d.mdx)("h2",{id:"build-container"},"Build container"),(0,d.mdx)("ul",null,(0,d.mdx)("li",{parentName:"ul"},(0,d.mdx)("strong",{parentName:"li"},"Container name"),": build"),(0,d.mdx)("li",{parentName:"ul"},(0,d.mdx)("strong",{parentName:"li"},"Docker base image"),": ",(0,d.mdx)("a",{parentName:"li",href:"https://hub.docker.com/r/magento/magento-cloud-docker-php"},"magento/magento-cloud-docker-php"),", which is based on the Docker ",(0,d.mdx)("a",{parentName:"li",href:"https://hub.docker.com/_/php"},"php")," image")),(0,d.mdx)("p",null,"The Build container mimics the behavior of the Adobe Commerce on cloud infrastructure build process so that testing the build and deploy process is as close to testing in production as possible."),(0,d.mdx)("p",null,"You can run build commands manually from the build container to perform individual steps from the build process. For example, you can run the following command to deploy static content:"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-bash"},"docker compose run --rm build magento-command setup:static-content:deploy\n")),(0,d.mdx)("h2",{id:"cron-container"},"Cron container"),(0,d.mdx)("ul",null,(0,d.mdx)("li",{parentName:"ul"},(0,d.mdx)("strong",{parentName:"li"},"Container name"),": cron"),(0,d.mdx)("li",{parentName:"ul"},(0,d.mdx)("strong",{parentName:"li"},"Docker base image"),": ",(0,d.mdx)("a",{parentName:"li",href:"https://hub.docker.com/r/magento/magento-cloud-docker-php"},"magento/magento-cloud-docker-php"),", which is based on the Docker ",(0,d.mdx)("a",{parentName:"li",href:"https://hub.docker.com/_/php"},"php")," image")),(0,d.mdx)("p",null,"The Cron container runs operations in the background immediately after the Docker environment starts. This container uses the cron configuration defined in the ",(0,d.mdx)("a",{parentName:"p",href:"https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/configure/app/properties/crons-property.html"},(0,d.mdx)("inlineCode",{parentName:"a"},"crons")," property of the ",(0,d.mdx)("inlineCode",{parentName:"a"},".magento.app.yaml")," file"),". This container has no custom configuration."),(0,d.mdx)(i,{variant:"info",slots:"text",mdxType:"InlineAlert"}),(0,d.mdx)("p",null,"To improve overall performance in the local Docker environment, the Cron container is not present by default. You can use the following command to add the Cron container to the Cloud Docker environment: ",(0,d.mdx)("inlineCode",{parentName:"p"},'./vendor/bin/ece-docker build:compose --mode="developer" --with-cron')),(0,d.mdx)("p",null,"For details on managing cron jobs in the Cloud Docker environment, see ",(0,d.mdx)("a",{parentName:"p",href:"../configure/manage-cron-jobs.md"},"Manage cron jobs"),"."),(0,d.mdx)("h2",{id:"deploy-container"},"Deploy container"),(0,d.mdx)("ul",null,(0,d.mdx)("li",{parentName:"ul"},(0,d.mdx)("strong",{parentName:"li"},"Container name"),": deploy"),(0,d.mdx)("li",{parentName:"ul"},(0,d.mdx)("strong",{parentName:"li"},"Docker base image"),": ",(0,d.mdx)("a",{parentName:"li",href:"https://hub.docker.com/r/magento/magento-cloud-docker-php"},"magento/magento-cloud-docker-php"),", which is based on the ",(0,d.mdx)("a",{parentName:"li",href:"https://hub.docker.com/_/php"},"php")," Docker image")),(0,d.mdx)("p",null,"The Deploy container mimics the Adobe Commerce on cloud infrastructure deploy process so that testing the build and deploy process is as close to testing in production as possible."),(0,d.mdx)("p",null,"You can run ",(0,d.mdx)("inlineCode",{parentName:"p"},"build")," and ",(0,d.mdx)("inlineCode",{parentName:"p"},"deploy")," commands manually from the deploy container. The following example reindexes the Adobe Commerce store:"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-bash"},"docker compose run --rm deploy magento-command index:reindex\n")),(0,d.mdx)("h2",{id:"node-container"},"Node container"),(0,d.mdx)("ul",null,(0,d.mdx)("li",{parentName:"ul"},(0,d.mdx)("strong",{parentName:"li"},"Container name"),": node"),(0,d.mdx)("li",{parentName:"ul"},(0,d.mdx)("strong",{parentName:"li"},"Docker base image"),": ",(0,d.mdx)("a",{parentName:"li",href:"https://hub.docker.com/_/node"},"node"))),(0,d.mdx)("p",null,"The Node container is based on the ",(0,d.mdx)("a",{parentName:"p",href:"https://hub.docker.com/_/node"},"official Node Docker image"),". You can use the container to install NPM dependencies, such as Gulp, or run any Node-based command-line tools."),(0,d.mdx)("p",null,"To add the Node container to the Docker environment, you must specify the Node version to install:"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-bash"},"./vendor/bin/ece-docker build:compose --node <version>\n")))}u.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-docker-containers-cli-md-b95eb074e3d483f694cb.js.map